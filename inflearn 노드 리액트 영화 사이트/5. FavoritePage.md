## Favorite Page

Favorite 기능을 통해 추가된 영화들을 모아서 보여주는 페이지를 작성하도록 한다.

### 페이지 추가하기

새로운 페이지를 하나 만들어줄 것이기 때문에 views 폴더에 FavoritePage 폴더를 만들어 FavoritePage.js 를 생성하고 App.js 에 라우트 문구를 추가해준다.

Favorite 목록은 로그인한 유저만 입장할 수 있기 때문에 auth 는 true 로 설정해준다.

```
// src/components/App.js
import FavoritePage from "./views/FavoritePage/FavoritePage";

function App() {
  const AuthFavoritePage = auth(FavoritePage, true);
  ...

  return (
    
    ...

    <Route exact path="/favorite" element={<AuthFavoritePage />} />

    ...
  )
}
```

### Favorite 페이지 템플릿 만들기

Favorite 페이지에는 표를 만들어 좋아요 버튼을 누른 영화들의 목록을 보여주고, 각 영화 항목에는 삭제 버튼이 있도록 한다.

좋아요 누른 영화 목록을 저장하기 위한 state 도 하나 만들어준다.

```
// src/components/views/FavoritePage/FavoritePage.js
import axios from "axios";
import React, { useEffect, useState } from "react";
import "./favorite.css";

function FavoritePage() {
  const [Favorites, setFavorites] = useState([]);

  return (
    <div style={{ width: "85%", margin: "3rem auto" }}>
      <h2>Favorite Movies</h2>
      <hr />
      <table>
        <thead>
          <tr>
            <th>Movie Title</th>
            <th>Movie Runtime</th>
            <td>Remove from Favorites</td>
          </tr>
        </thead>
        <tbody>
          

        </tbody>
      </table>
    </div>
  );
}

export default FavoritePage;
```

### Favorite 목록 불러와 표시하기

좋아요 목록을 제공받을 endpoint 를 정하고, 서버에 userId 를 제공한다.

서버에서는 userId 를 확인하여, 해당 아이디가 좋아요 누른 영화의 목록을 확인하여 리스트 형태로 응답한다.

```
// routes/favorite.js
router.post("/getfavoredmovies", (req, res) => {
  Favorite.find({ userFrom: req.body.userFrom }).exec((err, favorites) => {
    if (err) return res.status(400).send(err);
    return res.status(200).json({ success: true, favorites });
  });
});
```

그리고 프론트에서는 전달받은 리스트를 가지고 표로 표시할 수 있도록 map 시켜준다.

```
// src/components/views/FavoritePage/FavoritePage.js
import axios from "axios";
import React, { useEffect, useState } from "react";
import "./favorite.css";

function FavoritePage() {
  const [Favorites, setFavorites] = useState([]);

  const variable = {
    userFrom: localStorage.getItem("userId"),
  };

  useEffect(() => {
    axios.post("/api/favorite/getfavoredmovies", variable).then((response) => {
      //   console.log(response);
      if (response.data.success) {
        setFavorites(response.data.favorites);
      } else {
        alert("영화 정보를 가져오는데 실패했습니다.");
      }
    });
    // eslint-disable-next-line
  }, []);

  return (
    <div style={{ width: "85%", margin: "3rem auto" }}>
      <h2>Favorite Movies</h2>
      <hr />
      <table>
        <thead>
          <tr>
            <th>Movie Title</th>
            <th>Movie Runtime</th>
            <td>Remove from Favorites</td>
          </tr>
        </thead>
        <tbody>
          {Favorites.map((favorite, index) => (
            <tr key={index}>
              <td>{favorite.movieTitle}</td>
              <td>{favorite.movieRuntime}</td>
              <td>
                <button>Remove</button>
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
}

export default FavoritePage;
```