## GIT

GIT: distributed version control system (분산 버전 관리 시스템)

```
> git --version
```

### git 저장소 생성

```
> git init
```

### gitignore

모듈 파일, 혹은 개인 정보를 담은 파일 등은 외부에 노출되면 안되기 때문에 해당 정보는 git이 저장소에 저장하지 않도록 제외처리 해주어야 한다.

그러한 역할을 하는 것이 .gitignore 파일

```
// .gitignore
node_modules
```

현재는 다른 파일은 없고, 모듈 파일들은 git 을 통해 공유되지 않아도 되기 때문에 node_modules 파일만 지정해주었다.

### staging

```
> git add .
```

. 은 모든 파일을 의미하고, 현재 폴더 안에 있는 모든 파일들을 staging 단계로 만들어준다.

### Local Machine 에 저장

```
> git commit -m "comments"
```

staging 단계에 있는 파일들에 코멘트를 달아 로컬 저장소에 저장

### SSH 를 이용한 GITHUB 이용

로컬 저장소에서 리모트 저장소로 전송할 때 보안을 지키기 위해 SSH(Secured Shell) 이용

```
> ls -a ~/.ssh
```

입력하여 ssh를 위한 키가 생성되어 있는지 확인한다. id_rsa 혹은 id_ed25519 등의 파일과 .pub 파일이 쌍으로 있으면 이미 생성되어 있는 것이고, 없다면 새로 생성해야 한다.

#### SSH key 생성하기

```
> ssh-keygen -t ed25519 -C "useremail"

> ssh-keygen -t rsa -b 4096 -C "useremail"
```

위 문구로 생성하고, ed25519 방식이 작동하지 않는다면 아래의 문구로 진행한다. 비밀번호 등을 생성하고 다시

```
> ls -a ~/.ssh
```

를 입력하면 정상적으로 키 쌍이 생성된 것을 확인할 수 있다.

```
> vim ~/.ssh/config
```

```
Host *
  AddKeysToAgent yes
  UseKeychain yes
  IdentityFile ~/.ssh/id_ed25519
```

config 파일을 열어 (혹은 생성하여) 아래와 같은 문구를 입력 후 :wq 로 저장하고 빠져나온다.

```
> ssh-add -K ~/.ssh/id_ed25519
```

위 문장을 터미널에 입력하여 ssh private key를 ssh agent 에 키를 등록해준다.

#### ssh 공개키를 GITHUB에 등록하기

```
> pbcopy < ~/.ssh/id_ed25519.pub
```

위 문장을 터미널에 입력하면 공개키가 클립보드에 저장되게 되고, 이를 github에서 등록해주면 완료된다.

Settings - SSH and GPG keys - New SSH key

### GITHUB에 저장하기 전에 비밀번호 정보 분리하기

mongodb+srv ... 문자열을 통해 mongoDB 에 접속하기 위해서는 문자열 중간에 데이터베이스의 아이디와 비밀번호가 들어간다.

이러한 정보는 GIT을 통해 공유될 경우 보안 문제가 발생할 수 있기 때문에 공유에 주의해야 한다.

이러한 파일을 공유하지 않기 위해 json 파일로 분리하여 gitignore 을 통해 공유를 제한하도록 한다.

#### json 파일 생성

```
// secret_key.json
{
    "password": ...
}
```

위와 같이 json 파일에 비밀번호를 저장해준다.

#### 비밀번호 문자열 대체

```
// index.js
const secret_key = require("./secret_key.json");

mongoose
  .connect("mongodb+srv://4802852:" + secret_key.password + "@cluster0.7uhuwcr.mongodb.net/?retryWrites=true&w=majority", {
```

기존에 \<password> 칸에 비밀번호를 직접 저장했다면, 위와 같이 파일로 분리하고 이를 index.js 에서 불러와 이용함으로써 key가 공유되어 보안 문제가 발생하는 것을 예방할 수 있다.

